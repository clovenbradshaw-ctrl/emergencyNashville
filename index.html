<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Nashville Winter Resources</title>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      min-height: 100vh;
      min-height: 100dvh;
      padding: 1.5rem 1rem;
      padding-top: max(1.5rem, env(safe-area-inset-top));
      padding-bottom: max(1.5rem, env(safe-area-inset-bottom));
      padding-left: max(1rem, env(safe-area-inset-left));
      padding-right: max(1rem, env(safe-area-inset-right));
      color: #fff;
      -webkit-text-size-adjust: 100%;
    }

    .container {
      max-width: 480px;
      margin: 0 auto;
    }

    @media (max-width: 360px) {
      body {
        padding: 1rem 0.75rem;
        padding-top: max(1rem, env(safe-area-inset-top));
        padding-bottom: max(1rem, env(safe-area-inset-bottom));
      }
    }
    
    .lang-toggle {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: center;
      margin-bottom: 1.5rem;
    }
    
    .lang-btn {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      padding: 0.6rem 0.85rem;
      min-height: 44px;
      color: #94a3b8;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      touch-action: manipulation;
    }

    @media (hover: hover) {
      .lang-btn:hover {
        background: rgba(255, 255, 255, 0.12);
        color: #fff;
      }
    }

    .lang-btn:active {
      background: rgba(255, 255, 255, 0.18);
      color: #fff;
      transform: scale(0.97);
    }

    .lang-btn:focus-visible {
      outline: 2px solid #60a5fa;
      outline-offset: 2px;
    }

    .lang-btn.active {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.3);
      color: #fff;
    }
    
    header {
      text-align: center;
      margin-bottom: 1.75rem;
    }
    
    h1 {
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      letter-spacing: -0.02em;
      line-height: 1.2;
    }

    @media (max-width: 360px) {
      h1 {
        font-size: 1.4rem;
      }
    }

    .subtitle {
      color: #94a3b8;
      font-size: 0.95rem;
      line-height: 1.4;
    }
    
    .section {
      margin-bottom: 1.25rem;
    }
    
    .section-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: #64748b;
      margin-bottom: 0.6rem;
      padding-left: 0.25rem;
    }

    .links {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    a.link {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 1rem;
      min-height: 52px;
      color: #fff;
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 500;
      transition: all 0.15s ease;
      touch-action: manipulation;
    }

    a.link i {
      font-size: 1.35rem;
      opacity: 0.8;
      flex-shrink: 0;
    }

    @media (hover: hover) {
      a.link:hover {
        background: rgba(255, 255, 255, 0.15);
        border-color: rgba(255, 255, 255, 0.2);
        transform: translateY(-2px);
      }
    }

    a.link:active {
      background: rgba(255, 255, 255, 0.18);
      transform: scale(0.98);
    }

    a.link:focus-visible {
      outline: 2px solid #60a5fa;
      outline-offset: 2px;
    }
    
    .featured {
      background: linear-gradient(135deg, #e63946 0%, #d62839 100%);
      border-color: transparent;
      font-weight: 600;
    }

    @media (hover: hover) {
      .featured:hover {
        background: linear-gradient(135deg, #f1404e 0%, #e63946 100%);
        border-color: transparent;
      }
    }

    .featured:active {
      background: linear-gradient(135deg, #d62839 0%, #c41e2e 100%);
    }

    .featured i {
      opacity: 1;
    }

    /* Emergency Link - Subtle utility style */
    .emergency-link {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      color: #f87171;
      font-size: 0.85rem;
      font-weight: 500;
      text-decoration: none;
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      transition: all 0.15s ease;
      background: rgba(248, 113, 113, 0.1);
      border: 1px solid rgba(248, 113, 113, 0.2);
    }

    .emergency-link i {
      font-size: 1rem;
    }

    .emergency-link:hover {
      background: rgba(248, 113, 113, 0.2);
      color: #fca5a5;
    }

    .emergency-link:active {
      transform: scale(0.98);
    }

    .emergency-link:focus-visible {
      outline: 2px solid #f87171;
      outline-offset: 2px;
    }

    .header-utility {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 0.75rem;
    }

    [dir="rtl"] .header-utility {
      justify-content: flex-start;
    }

    footer {
      text-align: center;
      margin-top: 2rem;
      padding-top: 1.25rem;
      padding-bottom: 0.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      color: #64748b;
      font-size: 0.8rem;
    }

    .admin-link {
      color: #475569;
      font-size: 0.7rem;
      text-decoration: none;
      cursor: pointer;
      margin-top: 0.75rem;
      display: inline-block;
      transition: color 0.15s ease;
    }

    .admin-link:hover {
      color: #64748b;
    }

    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(4px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: #1e293b;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 1.5rem;
      width: 100%;
      max-width: 320px;
      text-align: center;
    }

    .modal h3 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: #fff;
    }

    .modal input {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      color: #fff;
      font-size: 0.95rem;
      margin-bottom: 1rem;
    }

    .modal input:focus {
      outline: none;
      border-color: #60a5fa;
    }

    .modal-buttons {
      display: flex;
      gap: 0.5rem;
    }

    .modal-btn {
      flex: 1;
      padding: 0.75rem 1rem;
      border: none;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .modal-btn.cancel {
      background: rgba(255, 255, 255, 0.1);
      color: #94a3b8;
    }

    .modal-btn.cancel:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .modal-btn.submit {
      background: #3b82f6;
      color: #fff;
    }

    .modal-btn.submit:hover {
      background: #2563eb;
    }

    .modal-error {
      color: #f87171;
      font-size: 0.8rem;
      margin-bottom: 0.75rem;
      display: none;
    }

    .modal-error.show {
      display: block;
    }

    [dir="rtl"] a.link {
      flex-direction: row-reverse;
      text-align: right;
    }

    [dir="rtl"] .section-title {
      padding-left: 0;
      padding-right: 0.25rem;
      text-align: right;
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        transition: none !important;
        transform: none !important;
      }
      html {
        scroll-behavior: auto;
      }
    }

    @supports (-webkit-touch-callout: none) {
      body {
        min-height: -webkit-fill-available;
      }
    }

    /* Weather Forecast Styles */
    .forecast-section {
      margin-bottom: 1.25rem;
    }

    .forecast-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.6rem;
      gap: 0.5rem;
    }

    .forecast-header .section-title {
      margin-bottom: 0;
    }

    .zip-input-wrapper {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 8px;
      padding: 0.35rem 0.5rem;
    }

    .zip-input-wrapper i {
      color: #64748b;
      font-size: 0.9rem;
    }

    #zipInput {
      background: transparent;
      border: none;
      outline: none;
      color: #fff;
      font-family: inherit;
      font-size: 0.85rem;
      width: 50px;
      letter-spacing: 0.05em;
    }

    #zipInput::placeholder {
      color: #64748b;
    }

    #fetchBtn {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: #94a3b8;
      padding: 0.3rem 0.6rem;
      border-radius: 6px;
      font-family: inherit;
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    #fetchBtn:hover {
      background: rgba(255, 255, 255, 0.15);
      color: #fff;
    }

    .forecast-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 0.5rem;
    }

    .day-card {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 0.75rem 0.5rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      transition: all 0.2s ease;
    }

    .day-card:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.15);
    }

    .day-name {
      font-size: 0.65rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: #64748b;
      margin-bottom: 0.25rem;
    }

    .day-date {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #fff;
    }

    .weather-icon {
      font-size: 1.75rem;
      margin-bottom: 0.35rem;
      color: #60a5fa;
    }

    .condition {
      font-size: 0.65rem;
      color: #94a3b8;
      margin-bottom: 0.5rem;
      line-height: 1.3;
      min-height: 1.6rem;
    }

    .temps {
      width: 100%;
    }

    .temp-high, .temp-low {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.25rem;
      font-size: 0.8rem;
    }

    .temp-high {
      color: #f97316;
      margin-bottom: 0.15rem;
    }

    .temp-low {
      color: #38bdf8;
    }

    .temp-high i, .temp-low i {
      font-size: 0.7rem;
    }

    .forecast-loading, .forecast-error {
      grid-column: 1 / -1;
      text-align: center;
      padding: 2rem 1rem;
      color: #64748b;
    }

    .forecast-loading i {
      font-size: 2rem;
      animation: pulse 1.5s ease-in-out infinite;
      margin-bottom: 0.5rem;
      display: block;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }

    .forecast-error {
      color: #f87171;
    }

    .forecast-error i {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      display: block;
    }

    .location-display {
      font-size: 0.75rem;
      color: #64748b;
      text-align: center;
      margin-bottom: 0.5rem;
      min-height: 1rem;
    }

    @media (max-width: 400px) {
      .forecast-grid {
        grid-template-columns: repeat(3, 1fr);
      }
      .day-card:nth-child(4),
      .day-card:nth-child(5) {
        grid-column: span 1;
      }
      .forecast-grid {
        grid-template-columns: repeat(3, 1fr);
      }
      /* Center last 2 cards */
      .forecast-grid::after {
        content: '';
        grid-column: span 1;
      }
    }

    @media (max-width: 320px) {
      .forecast-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    [dir="rtl"] .forecast-header {
      flex-direction: row-reverse;
    }

    [dir="rtl"] .zip-input-wrapper {
      flex-direction: row-reverse;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="lang-toggle">
      <button class="lang-btn active" data-lang="en">English</button>
      <button class="lang-btn" data-lang="es">Español</button>
      <button class="lang-btn" data-lang="ar">العربية</button>
      <button class="lang-btn" data-lang="ku">کوردی</button>
      <button class="lang-btn" data-lang="vi">Tiếng Việt</button>
    </div>
    
    <header>
      <div class="header-utility">
        <a href="emergency.html" class="emergency-link">
          <i class="ph ph-siren"></i>
          <span data-i18n="emergency_911">911 Location</span>
        </a>
      </div>
      <h1 data-i18n="title">Nashville Winter Resources</h1>
      <p class="subtitle" data-i18n="subtitle">Shelter, food & support during extreme weather</p>
    </header>

    <section class="section">
      <div class="section-title" data-i18n="start">Start Here</div>
      <div class="links">
        <a href="https://wttin.org/" class="link featured external-link" target="_blank" rel="noopener noreferrer" data-href="https://wttin.org/">
          <i class="ph ph-compass"></i>
          <span data-i18n="wttin">Where to Turn in Nashville</span>
        </a>
      </div>
    </section>

    <section class="forecast-section">
      <div class="forecast-header">
        <div class="section-title" data-i18n="forecast">5-Day Forecast</div>
        <div class="zip-input-wrapper">
          <i class="ph ph-map-pin"></i>
          <input type="text" id="zipInput" placeholder="37206" maxlength="5" value="37206" inputmode="numeric" pattern="[0-9]*">
          <button id="fetchBtn" data-i18n="update_btn">Go</button>
        </div>
      </div>
      <p class="location-display" id="locationDisplay"></p>
      <div class="forecast-grid" id="forecastGrid">
        <div class="forecast-loading">
          <i class="ph ph-cloud"></i>
          <p data-i18n="loading_forecast">Loading forecast...</p>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="section-title" data-i18n="official">Official Resource Hubs</div>
      <div class="links">
        <a href="https://www.nashville.gov/departments/emergency-management/news/january-27-winter-weather-update" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.nashville.gov/departments/emergency-management/news/january-27-winter-weather-update">
          <i class="ph ph-cloud-snow"></i>
          <span data-i18n="nashville_weather">Nashville.gov Winter Weather Updates</span>
        </a>
        <a href="https://www.nashville.gov/departments/office-homeless-services/get-connected/extreme-weather" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.nashville.gov/departments/office-homeless-services/get-connected/extreme-weather">
          <i class="ph ph-thermometer-cold"></i>
          <span data-i18n="ohs_extreme">Metro OHS – Extreme Weather</span>
        </a>
        <a href="https://www.nashville.gov/departments/office-homeless-services/get-connected/extreme-weather/shelters" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.nashville.gov/departments/office-homeless-services/get-connected/extreme-weather/shelters">
          <i class="ph ph-list-bullets"></i>
          <span data-i18n="shelter_list">Metro Shelter List</span>
        </a>
        <a href="https://www.tn.gov/tema/tennessee-shelters.html" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.tn.gov/tema/tennessee-shelters.html">
          <i class="ph ph-map-trifold"></i>
          <span data-i18n="tema_map">TEMA Statewide Shelter Map</span>
        </a>
        <a href="https://www.tn.gov/tema/updates/2026-disasters/january-2026-winter-weather.html" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.tn.gov/tema/updates/2026-disasters/january-2026-winter-weather.html">
          <i class="ph ph-warning"></i>
          <span data-i18n="tema_hub">TEMA Winter Weather Hub</span>
        </a>
        <a href="https://www.fema.gov/disaster/2026-winter-storm" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.fema.gov/disaster/2026-winter-storm">
          <i class="ph ph-flag"></i>
          <span data-i18n="fema">FEMA 2026 Winter Storm</span>
        </a>
      </div>
    </section>
    
    <section class="section">
      <div class="section-title" data-i18n="shelter">Shelter & Outreach</div>
      <div class="links">
        <a href="https://www.roomintheinn.org/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.roomintheinn.org/">
          <i class="ph ph-bed"></i>
          <span>Room in the Inn</span>
        </a>
        <a href="https://www.opentablenashville.org/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.opentablenashville.org/">
          <i class="ph ph-hand-heart"></i>
          <span>Open Table Nashville</span>
        </a>
        <a href="https://thecontributor.org/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://thecontributor.org/">
          <i class="ph ph-newspaper"></i>
          <span>The Contributor</span>
        </a>
        <a href="https://www.peoplelovingnashville.com/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.peoplelovingnashville.com/">
          <i class="ph ph-users"></i>
          <span>People Loving Nashville</span>
        </a>
      </div>
    </section>
    
    <section class="section">
      <div class="section-title" data-i18n="food">Food</div>
      <div class="links">
        <a href="https://www.secondharvestmidtn.org/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.secondharvestmidtn.org/">
          <i class="ph ph-package"></i>
          <span data-i18n="second_harvest">Second Harvest Food Bank</span>
        </a>
        <a href="https://www.secondharvestmidtn.org/find-resources/find-food/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.secondharvestmidtn.org/find-resources/find-food/">
          <i class="ph ph-magnifying-glass"></i>
          <span data-i18n="find_food">Second Harvest – Find Food</span>
        </a>
        <a href="https://dreamstreetstn.com/mobilefood" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://dreamstreetstn.com/mobilefood">
          <i class="ph ph-truck"></i>
          <span data-i18n="dream_streets">Dream Streets Mobile Food</span>
        </a>
      </div>
    </section>
    
    <section class="section">
      <div class="section-title" data-i18n="immigrant">Immigrant Community</div>
      <div class="links">
        <a href="https://www.conexionamericas.org/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.conexionamericas.org/">
          <i class="ph ph-globe-hemisphere-west"></i>
          <span>Conexión Américas / Casa Azafrán</span>
        </a>
      </div>
    </section>
    
    <section class="section">
      <div class="section-title" data-i18n="legal">Legal & Other Resources</div>
      <div class="links">
        <a href="https://las.org/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://las.org/">
          <i class="ph ph-scales"></i>
          <span data-i18n="legal_aid">Legal Aid Society of Middle TN</span>
        </a>
        <a href="https://www.wnpt.org/agingmatters/unhoused/" class="link external-link" target="_blank" rel="noopener noreferrer" data-href="https://www.wnpt.org/agingmatters/unhoused/">
          <i class="ph ph-info"></i>
          <span data-i18n="npt">NPT Unhoused Resources</span>
        </a>
      </div>
    </section>
    
    <footer>
      <span data-i18n="footer">Share widely · Updated Jan 2026</span>
      <br>
      <a class="admin-link" id="adminLink">Admin</a>
    </footer>
  </div>

  <div class="modal-overlay" id="adminModal">
    <div class="modal">
      <h3>Admin Login</h3>
      <div class="modal-error" id="modalError">Incorrect password</div>
      <input type="password" id="adminPassword" placeholder="Enter password" autocomplete="off">
      <div class="modal-buttons">
        <button class="modal-btn cancel" id="modalCancel">Cancel</button>
        <button class="modal-btn submit" id="modalSubmit">Login</button>
      </div>
    </div>
  </div>

  <script>
    const translations = {
      en: {
        title: "Nashville Winter Resources",
        subtitle: "Shelter, food & support during extreme weather",
        emergency_911: "911 Location",
        start: "Start Here",
        wttin: "Where to Turn in Nashville",
        official: "Official Resource Hubs",
        nashville_weather: "Nashville.gov Winter Weather Updates",
        ohs_extreme: "Metro OHS – Extreme Weather",
        shelter_list: "Metro Shelter List",
        tema_map: "TEMA Statewide Shelter Map",
        tema_hub: "TEMA Winter Weather Hub",
        fema: "FEMA 2026 Winter Storm",
        shelter: "Shelter & Outreach",
        food: "Food",
        second_harvest: "Second Harvest Food Bank",
        find_food: "Second Harvest – Find Food",
        dream_streets: "Dream Streets Mobile Food",
        immigrant: "Immigrant Community",
        legal: "Legal & Other Resources",
        legal_aid: "Legal Aid Society of Middle TN",
        npt: "NPT Unhoused Resources",
        footer: "Share widely · Updated Jan 2026",
        forecast: "5-Day Forecast",
        update_btn: "Go",
        loading_forecast: "Loading forecast..."
      },
      es: {
        title: "Recursos de Invierno en Nashville",
        subtitle: "Refugio, comida y apoyo durante clima extremo",
        emergency_911: "Ubicación 911",
        start: "Empiece Aquí",
        wttin: "Dónde Acudir en Nashville",
        official: "Centros de Recursos Oficiales",
        nashville_weather: "Actualizaciones del Clima Invernal",
        ohs_extreme: "OHS – Clima Extremo",
        shelter_list: "Lista de Refugios de Metro",
        tema_map: "Mapa de Refugios de Tennessee",
        tema_hub: "Centro de Clima Invernal TEMA",
        fema: "FEMA Tormenta de Invierno 2026",
        shelter: "Refugio y Alcance",
        food: "Comida",
        second_harvest: "Banco de Alimentos Second Harvest",
        find_food: "Second Harvest – Encontrar Comida",
        dream_streets: "Dream Streets Comida Móvil",
        immigrant: "Comunidad Inmigrante",
        legal: "Recursos Legales y Otros",
        legal_aid: "Sociedad de Ayuda Legal de Middle TN",
        npt: "Recursos NPT para Personas sin Hogar",
        footer: "Comparte · Actualizado Ene 2026",
        forecast: "Pronóstico de 5 Días",
        update_btn: "Ir",
        loading_forecast: "Cargando pronóstico..."
      },
      ar: {
        title: "موارد الشتاء في ناشفيل",
        subtitle: "مأوى وطعام ودعم أثناء الطقس القاسي",
        emergency_911: "موقع 911",
        start: "ابدأ هنا",
        wttin: "أين تتوجه في ناشفيل",
        official: "مراكز الموارد الرسمية",
        nashville_weather: "تحديثات طقس الشتاء",
        ohs_extreme: "خدمات الطقس القاسي",
        shelter_list: "قائمة الملاجئ",
        tema_map: "خريطة ملاجئ تينيسي",
        tema_hub: "مركز طقس الشتاء TEMA",
        fema: "FEMA عاصفة الشتاء 2026",
        shelter: "المأوى والتواصل",
        food: "الطعام",
        second_harvest: "بنك الطعام Second Harvest",
        find_food: "Second Harvest – ابحث عن طعام",
        dream_streets: "Dream Streets طعام متنقل",
        immigrant: "مجتمع المهاجرين",
        legal: "الموارد القانونية وغيرها",
        legal_aid: "جمعية المساعدة القانونية",
        npt: "موارد NPT للمشردين",
        footer: "شارك على نطاق واسع · محدث يناير 2026",
        forecast: "توقعات 5 أيام",
        update_btn: "ابحث",
        loading_forecast: "جارٍ تحميل التوقعات..."
      },
      ku: {
        title: "سەرچاوەکانی زستانی ناشڤیل",
        subtitle: "پەناگا، خواردن و پشتیوانی لە کاتی کەشوهەوای سەخت",
        emergency_911: "شوێنی 911",
        start: "لێرەوە دەست پێبکە",
        wttin: "لە ناشڤیل بۆ کوێ بڕۆیت",
        official: "ناوەندە فەرمییەکانی سەرچاوە",
        nashville_weather: "نوێکردنەوەکانی کەشوهەوای زستان",
        ohs_extreme: "خزمەتگوزارییەکانی کەشوهەوای سەخت",
        shelter_list: "لیستی پەناگاکان",
        tema_map: "نەخشەی پەناگاکانی تێنێسی",
        tema_hub: "ناوەندی کەشوهەوای زستانی TEMA",
        fema: "زریانی زستانی FEMA 2026",
        shelter: "پەناگا و دەستڕاگەیشتن",
        food: "خواردن",
        second_harvest: "بانکی خواردنی Second Harvest",
        find_food: "Second Harvest – خواردن بدۆزەرەوە",
        dream_streets: "خواردنی گەڕۆکی Dream Streets",
        immigrant: "کۆمەڵگای کۆچبەران",
        legal: "سەرچاوە یاساییەکان و هیتر",
        legal_aid: "کۆمەڵەی یارمەتی یاسایی",
        npt: "سەرچاوەکانی NPT بۆ بێماڵان",
        footer: "بڵاوی بکەرەوە · نوێکراوەتەوە کانوونی دووەم 2026",
        forecast: "پێشبینی 5 ڕۆژ",
        update_btn: "بڕۆ",
        loading_forecast: "پێشبینی بارکردن..."
      },
      vi: {
        title: "Tài Nguyên Mùa Đông Nashville",
        subtitle: "Nơi trú ẩn, thực phẩm & hỗ trợ trong thời tiết khắc nghiệt",
        emergency_911: "Vị Trí 911",
        start: "Bắt Đầu Tại Đây",
        wttin: "Nơi Hướng Dẫn Tại Nashville",
        official: "Trung Tâm Tài Nguyên Chính Thức",
        nashville_weather: "Cập Nhật Thời Tiết Mùa Đông",
        ohs_extreme: "OHS – Thời Tiết Khắc Nghiệt",
        shelter_list: "Danh Sách Nơi Trú Ẩn Metro",
        tema_map: "Bản Đồ Nơi Trú Ẩn Toàn Tiểu Bang",
        tema_hub: "Trung Tâm Thời Tiết Mùa Đông TEMA",
        fema: "FEMA Bão Tuyết 2026",
        shelter: "Nơi Trú Ẩn & Tiếp Cận",
        food: "Thực Phẩm",
        second_harvest: "Ngân Hàng Thực Phẩm Second Harvest",
        find_food: "Second Harvest – Tìm Thực Phẩm",
        dream_streets: "Dream Streets Thực Phẩm Di Động",
        immigrant: "Cộng Đồng Người Nhập Cư",
        legal: "Tài Nguyên Pháp Lý & Khác",
        legal_aid: "Hội Trợ Giúp Pháp Lý Middle TN",
        npt: "Tài Nguyên NPT cho Người Vô Gia Cư",
        footer: "Chia sẻ rộng rãi · Cập nhật Tháng 1 2026",
        forecast: "Dự Báo 5 Ngày",
        update_btn: "Tìm",
        loading_forecast: "Đang tải dự báo..."
      }
    };

    const rtlLangs = ['ar', 'ku'];

    const langCodes = {
      en: 'en',
      es: 'es',
      ar: 'ar',
      ku: 'ckb',
      vi: 'vi'
    };

    function updateExternalLinks(lang) {
      document.querySelectorAll('.external-link').forEach(link => {
        const originalUrl = link.dataset.href;
        if (lang === 'en') {
          link.href = originalUrl;
        } else {
          link.href = `https://translate.google.com/translate?sl=en&tl=${langCodes[lang]}&u=${encodeURIComponent(originalUrl)}`;
        }
      });
    }

    function setLanguage(lang) {
      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === lang);
      });

      if (rtlLangs.includes(lang)) {
        document.documentElement.setAttribute('dir', 'rtl');
        document.documentElement.setAttribute('lang', lang);
      } else {
        document.documentElement.setAttribute('dir', 'ltr');
        document.documentElement.setAttribute('lang', lang);
      }

      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.dataset.i18n;
        if (translations[lang][key]) {
          el.textContent = translations[lang][key];
        }
      });

      updateExternalLinks(lang);
      localStorage.setItem('nashville-resources-lang', lang);
    }

    document.querySelectorAll('.lang-btn').forEach(btn => {
      btn.addEventListener('click', () => setLanguage(btn.dataset.lang));
    });

    const savedLang = localStorage.getItem('nashville-resources-lang');
    if (savedLang && translations[savedLang]) {
      setLanguage(savedLang);
    }

    // Admin modal functionality
    const adminLink = document.getElementById('adminLink');
    const adminModal = document.getElementById('adminModal');
    const adminPassword = document.getElementById('adminPassword');
    const modalCancel = document.getElementById('modalCancel');
    const modalSubmit = document.getElementById('modalSubmit');
    const modalError = document.getElementById('modalError');

    function openModal() {
      adminModal.classList.add('active');
      adminPassword.value = '';
      modalError.classList.remove('show');
      setTimeout(() => adminPassword.focus(), 100);
    }

    function closeModal() {
      adminModal.classList.remove('active');
      adminPassword.value = '';
      modalError.classList.remove('show');
    }

    function handleLogin() {
      const password = adminPassword.value;
      if (password) {
        // Store password hash in session and redirect to admin
        sessionStorage.setItem('adminAuth', btoa(password));
        window.location.href = 'admin.html';
      } else {
        modalError.textContent = 'Please enter a password';
        modalError.classList.add('show');
      }
    }

    adminLink.addEventListener('click', openModal);
    modalCancel.addEventListener('click', closeModal);
    modalSubmit.addEventListener('click', handleLogin);

    adminPassword.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') handleLogin();
      if (e.key === 'Escape') closeModal();
    });

    adminModal.addEventListener('click', (e) => {
      if (e.target === adminModal) closeModal();
    });

    // Weather Forecast Functionality
    const weatherCodes = {
      0: { label: 'Clear Sky', icon: 'ph-sun' },
      1: { label: 'Mostly Clear', icon: 'ph-sun' },
      2: { label: 'Partly Cloudy', icon: 'ph-cloud-sun' },
      3: { label: 'Overcast', icon: 'ph-cloud' },
      45: { label: 'Foggy', icon: 'ph-cloud-fog' },
      48: { label: 'Rime Fog', icon: 'ph-cloud-fog' },
      51: { label: 'Light Drizzle', icon: 'ph-cloud-rain' },
      53: { label: 'Moderate Drizzle', icon: 'ph-cloud-rain' },
      55: { label: 'Dense Drizzle', icon: 'ph-cloud-rain' },
      56: { label: 'Freezing Drizzle', icon: 'ph-cloud-rain' },
      57: { label: 'Heavy Freezing Drizzle', icon: 'ph-cloud-rain' },
      61: { label: 'Light Rain', icon: 'ph-cloud-rain' },
      63: { label: 'Moderate Rain', icon: 'ph-cloud-rain' },
      65: { label: 'Heavy Rain', icon: 'ph-cloud-rain' },
      66: { label: 'Freezing Rain', icon: 'ph-cloud-rain' },
      67: { label: 'Heavy Freezing Rain', icon: 'ph-cloud-rain' },
      71: { label: 'Light Snow', icon: 'ph-snowflake' },
      73: { label: 'Moderate Snow', icon: 'ph-snowflake' },
      75: { label: 'Heavy Snow', icon: 'ph-snowflake' },
      77: { label: 'Snow Grains', icon: 'ph-snowflake' },
      80: { label: 'Light Showers', icon: 'ph-cloud-rain' },
      81: { label: 'Moderate Showers', icon: 'ph-cloud-rain' },
      82: { label: 'Violent Showers', icon: 'ph-cloud-rain' },
      85: { label: 'Light Snow Showers', icon: 'ph-snowflake' },
      86: { label: 'Heavy Snow Showers', icon: 'ph-snowflake' },
      95: { label: 'Thunderstorm', icon: 'ph-cloud-lightning' },
      96: { label: 'Thunderstorm with Hail', icon: 'ph-cloud-lightning' },
      99: { label: 'Severe Thunderstorm', icon: 'ph-cloud-lightning' }
    };

    const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

    async function getCoordinates(zip) {
      const response = await fetch(`https://nominatim.openstreetmap.org/search?postalcode=${zip}&country=US&format=json&limit=1`);
      const data = await response.json();
      if (data.length === 0) throw new Error('Location not found');
      return {
        lat: parseFloat(data[0].lat),
        lon: parseFloat(data[0].lon),
        name: data[0].display_name.split(',').slice(0, 2).join(',').trim()
      };
    }

    async function getWeather(lat, lon) {
      const response = await fetch(
        `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=weather_code,temperature_2m_max,temperature_2m_min&temperature_unit=fahrenheit&timezone=auto&forecast_days=5`
      );
      return response.json();
    }

    function renderForecast(weather) {
      const grid = document.getElementById('forecastGrid');
      grid.innerHTML = '';

      weather.daily.time.forEach((date, index) => {
        const d = new Date(date + 'T12:00:00');
        const code = weather.daily.weather_code[index];
        const info = weatherCodes[code] || { label: 'Unknown', icon: 'ph-question' };
        const high = Math.round(weather.daily.temperature_2m_max[index]);
        const low = Math.round(weather.daily.temperature_2m_min[index]);

        const card = document.createElement('div');
        card.className = 'day-card';
        card.innerHTML = `
          <div class="day-name">${dayNames[d.getDay()]}</div>
          <div class="day-date">${monthNames[d.getMonth()]} ${d.getDate()}</div>
          <i class="ph ${info.icon} weather-icon"></i>
          <div class="condition">${info.label}</div>
          <div class="temps">
            <div class="temp-high">
              <i class="ph ph-arrow-up"></i>
              <span>${high}°</span>
            </div>
            <div class="temp-low">
              <i class="ph ph-arrow-down"></i>
              <span>${low}°</span>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    function showForecastError(message) {
      document.getElementById('forecastGrid').innerHTML = `
        <div class="forecast-error">
          <i class="ph ph-warning-circle"></i>
          <p>${message}</p>
        </div>
      `;
    }

    async function fetchForecast() {
      const zip = document.getElementById('zipInput').value.trim();
      if (!/^\d{5}$/.test(zip)) {
        showForecastError('Please enter a valid 5-digit ZIP code');
        return;
      }

      document.getElementById('forecastGrid').innerHTML = `
        <div class="forecast-loading">
          <i class="ph ph-cloud"></i>
          <p>Loading forecast...</p>
        </div>
      `;

      try {
        const coords = await getCoordinates(zip);
        document.getElementById('locationDisplay').textContent = coords.name;
        const weather = await getWeather(coords.lat, coords.lon);
        renderForecast(weather);
      } catch (err) {
        showForecastError('Unable to fetch forecast. Please check the ZIP code.');
        console.error(err);
      }
    }

    document.getElementById('fetchBtn').addEventListener('click', fetchForecast);
    document.getElementById('zipInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') fetchForecast();
    });

    // Load forecast on page load
    fetchForecast();
  </script>
</body>
</html>
